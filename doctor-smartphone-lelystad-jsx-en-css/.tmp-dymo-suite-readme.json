"# @dymo-print-suite/react\n\nReact hooks for interacting with DYMO Label Web Service.\nBuilt on top of `@dymo-print-suite/core`.\n\n## Installation\n\n```bash\nnpm install @dymo-print-suite/react\n# or\npnpm add @dymo-print-suite/react\n# or\nyarn add @dymo-print-suite/react\n```\n\n## Quick Start\n\n```tsx\nimport {\n  useDymoCheckService,\n  useDymoFetchPrinters,\n  useDymoOpenLabel,\n  printLabel,\n} from \"@dymo-print-suite/react\";\n\nfunction App() {\n  const status = useDymoCheckService();\n  const { printers, statusFetchPrinters } = useDymoFetchPrinters(status);\n\n  if (status === \"loading\") return <p>Checking DYMO service...</p>;\n  if (status === \"error\") return <p>DYMO service not available</p>;\n\n  return (\n    <div>\n      <h1>DYMO Service Connected!</h1>\n      {statusFetchPrinters === \"success\" && (\n        <ul>\n          {printers.map((p) => (\n            <li key={p.name}>{p.name}</li>\n          ))}\n        </ul>\n      )}\n    </div>\n  );\n}\n```\n\n## Hooks\n\n### `useDymoCheckService()`\n\nCheck if the DYMO Web Service is running on the user's machine.\n\n```tsx\nconst status = useDymoCheckService();\n// status: \"initial\" | \"loading\" | \"success\" | \"error\"\n```\n\n**Returns:** `ServiceStatus` - Current status of the service check.\n\n### `useDymoFetchPrinters(statusDymoService, modelPrinter?)`\n\nFetch available DYMO printers. Only runs when `statusDymoService` is `\"success\"`.\n\n```tsx\nconst status = useDymoCheckService();\nconst { statusFetchPrinters, printers, error } = useDymoFetchPrinters(status);\n```\n\n**Parameters:**\n- `statusDymoService` - Status from `useDymoCheckService()`\n- `modelPrinter` - Optional. Filter by printer model (default: `\"LabelWriterPrinter\"`)\n\n**Returns:** `FetchPrintersResult`\n```typescript\ninterface FetchPrintersResult {\n  statusFetchPrinters: ServiceStatus;\n  printers: DymoPrinter[];\n  error: Error | null;\n}\n```\n\n### `useDymoOpenLabel(statusDymoService, labelXML)`\n\nRender a label preview as a base64 PNG image.\n\n```tsx\nconst status = useDymoCheckService();\nconst { statusOpenLabel, label, error } = useDymoOpenLabel(status, labelXml);\n\nif (statusOpenLabel === \"success\" && label) {\n  const base64 = label.replace(/^\"|\"$/g, \"\");\n  return <img src={`data:image/png;base64,${base64}`} alt=\"Label preview\" />;\n}\n```\n\n**Parameters:**\n- `statusDymoService` - Status from `useDymoCheckService()`\n- `labelXML` - Label XML string\n\n**Returns:** `OpenLabelResult`\n```typescript\ninterface OpenLabelResult {\n  statusOpenLabel: ServiceStatus;\n  label: string | null;\n  error: Error | null;\n}\n```\n\n### `useData<T>(initialData)`\n\nLow-level utility hook for managing state with partial updates. Similar to `this.setState()` in class components, it merges updates into existing state rather than replacing it.\n\nThis hook is used internally by `useDymoFetchPrinters` and `useDymoOpenLabel`. You typically don't need this hook directly unless you're building custom hooks or need class-style state merging.\n\n```tsx\nimport { useData } from \"@dymo-print-suite/react\";\n\ninterface FormState {\n  name: string;\n  email: string;\n  loading: boolean;\n}\n\nfunction MyComponent() {\n  const [state, setState] = useData<FormState>({\n    name: \"\",\n    email: \"\",\n    loading: false,\n  });\n\n  const handleSubmit = async () => {\n    // Partial update - only changes 'loading', preserves 'name' and 'email'\n    setState({ loading: true });\n\n    await submitForm(state.name, state.email);\n\n    setState({ loading: false });\n  };\n\n  return (\n    <form>\n      <input\n        value={state.name}\n        onChange={(e) => setState({ name: e.target.value })}\n      />\n      <input\n        value={state.email}\n        onChange={(e) => setState({ email: e.target.value })}\n      />\n      <button disabled={state.loading} onClick={handleSubmit}>\n        Submit\n      </button>\n    </form>\n  );\n}\n```\n\n**Parameters:**\n\n- `initialData` - Initial state object\n\n**Returns:** `[T, Dispatch<Partial<T>>]` - A tuple of current state and a setter that accepts partial updates\n\n**When to use:**\n\n- Building custom async hooks that need to track multiple related values (status, data, error)\n- Managing form state where you want to update individual fields without spreading\n- Migrating class components that rely on `this.setState()` merge behavior\n\n**When to prefer higher-level hooks:**\n\n- For checking DYMO service status ÔåÆ use `useDymoCheckService()`\n- For fetching printers ÔåÆ use `useDymoFetchPrinters()`\n- For rendering label previews ÔåÆ use `useDymoOpenLabel()`\n\n## Printing Labels\n\nUse the `printLabel` function (re-exported from `@dymo-print-suite/core`):\n\n```tsx\nimport { printLabel } from \"@dymo-print-suite/react\";\n\nasync function handlePrint(printerName: string, labelXml: string) {\n  try {\n    await printLabel(printerName, labelXml);\n    console.log(\"Label printed successfully!\");\n  } catch (error) {\n    console.error(\"Print failed:\", error);\n  }\n}\n```\n\n## Complete Example\n\n```tsx\nimport { useState, useMemo } from \"react\";\nimport {\n  useDymoCheckService,\n  useDymoFetchPrinters,\n  useDymoOpenLabel,\n  printLabel,\n} from \"@dymo-print-suite/react\";\n\nconst labelTemplate = (name: string) => `<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<DieCutLabel Version=\"8.0\" Units=\"twips\">\n  <PaperOrientation>Landscape</PaperOrientation>\n  <ObjectInfo Name=\"Text\">\n    <TextObject>\n      <Name>TEXT</Name>\n      <StyledText>\n        <String>${name}</String>\n      </StyledText>\n    </TextObject>\n  </ObjectInfo>\n</DieCutLabel>`;\n\nexport default function App() {\n  const status = useDymoCheckService();\n  const { printers, statusFetchPrinters } = useDymoFetchPrinters(status);\n  const [name, setName] = useState(\"Hello World\");\n  const [selectedPrinter, setSelectedPrinter] = useState(\"\");\n\n  const labelXml = useMemo(() => labelTemplate(name), [name]);\n  const { label, statusOpenLabel } = useDymoOpenLabel(status, labelXml);\n\n  if (status === \"loading\") return <p>Checking DYMO service...</p>;\n  if (status === \"error\") return <p>DYMO Web Service is not running</p>;\n\n  return (\n    <div>\n      <h1>DYMO Label Printer</h1>\n\n      <input\n        value={name}\n        onChange={(e) => setName(e.target.value)}\n        placeholder=\"Enter label text\"\n      />\n\n      {statusOpenLabel === \"success\" && label && (\n        <img\n          src={`data:image/png;base64,${label.replace(/^\"|\"$/g, \"\")}`}\n          alt=\"Preview\"\n        />\n      )}\n\n      {statusFetchPrinters === \"success\" && (\n        <select onChange={(e) => setSelectedPrinter(e.target.value)}>\n          <option value=\"\">Select printer</option>\n          {printers.map((p) => (\n            <option key={p.name} value={p.name}>\n              {p.name}\n            </option>\n          ))}\n        </select>\n      )}\n\n      <button\n        disabled={!selectedPrinter}\n        onClick={() => printLabel(selectedPrinter, labelXml)}\n      >\n        Print\n      </button>\n    </div>\n  );\n}\n```\n\n## Re-exported from Core\n\nFor convenience, this package re-exports everything from `@dymo-print-suite/core`:\n\n**Functions:**\n- `printLabel` - Print a label to a DYMO printer\n- `dymoRequestBuilder` - Build custom requests to DYMO Web Service\n- `dymoUrlBuilder` - Build URLs for DYMO Web Service\n- `getDymoPrintersFromXml` - Parse printer list from XML\n- `isRequestCancelled` - Check if error is a cancellation\n- `localStore` / `localRetrieve` - Storage utilities\n\n**Constants:**\n- `WS_PROTOCOL`, `WS_START_PORT`, `WS_END_PORT`\n- `WS_CHECK_TIMEOUT`, `WS_COMMAND_TIMEOUT`\n- `WS_SVC_HOST`, `WS_SVC_HOST_LEGACY`, `WS_SVC_PATH`\n- `WS_ACTIONS`\n\n**Types:**\n- `DymoPrinter`, `DymoResponse`, `DymoRequestConfig`\n- `WsAction`, `WsActionValue`\n\n## Types\n\n```typescript\ntype ServiceStatus = \"initial\" | \"loading\" | \"success\" | \"error\";\n\ninterface DymoPrinter {\n  name: string;\n  modelName: string;\n  isLocal: boolean;\n  isTwinTurbo: boolean;\n  isConnected: boolean;\n}\n\ninterface FetchPrintersResult {\n  statusFetchPrinters: ServiceStatus;\n  printers: DymoPrinter[];\n  error: Error | null;\n}\n\ninterface OpenLabelResult {\n  statusOpenLabel: ServiceStatus;\n  label: string | null;\n  error: Error | null;\n}\n```\n\n## Migration from react-dymo-hooks\n\nIf you're migrating from `react-dymo-hooks`, update your imports:\n\n```diff\n- import { useDymoCheckService, useDymoFetchPrinters } from \"react-dymo-hooks\";\n+ import { useDymoCheckService, useDymoFetchPrinters } from \"@dymo-print-suite/react\";\n```\n\nThe API is fully compatible.\n\n## Requirements\n\n- [DYMO Label Web Service](https://www.dymo.com/support?cfid=online-support-sdk) must be installed and running\n- React 16.8+ (hooks support)\n- Supported browsers: Chrome, Firefox, Edge, Safari\n\n## Related\n\n- [@dymo-print-suite/core](https://www.npmjs.com/package/@dymo-print-suite/core) - Core library (no React dependency)\n- [GitHub Repository](https://github.com/apenab/dymo-print-suite)\n\n## License\n\nMIT\n"
